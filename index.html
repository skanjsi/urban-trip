<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <script src="https://kit.fontawesome.com/0472eae8e7.js"></script>
    <title>Urban Trip</title>
    <link rel="stylesheet" href="css/styles.css" />
    <script src="https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.js"></script>
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <header class="header">
      <div class="header__header-column">
        <div class="header__title">
          <i class="fas fa-bicycle"></i>
        </div>
      </div>
      <div class="header__header-column">
        <a href="index.html" class="header__list">Trip Planner</a>
        <a href="tripinfo.html" class="header__list">Trip Info</a>
      </div>
      <div class="header__header-column">
        <input type="text" class="header__search" placeholder="Search places" />
        <i class="fas fa-search"></i>
      </div>
    </header>
    <div class="empty-filler"></div>
    <main class="main">
      <div class="map-name">Trip Planner</div>
      <div id="map"></div>

      <script>
        mapboxgl.accessToken =
          "pk.eyJ1IjoiaHl1bm9vb291IiwiYSI6ImNrMWozcnY2YzF3cXIzY3A2bjUyZ3oyZGsifQ.atI25r1hT051DYm-1pKV1w";
        var map = new mapboxgl.Map({
          container: "map",
          style: "mapbox://styles/hyunoooou/ck1xsb0dm8kuh1cpihsx92tcq",
          center: [127.051954, 37.544775], // 지도 중심 경위도
          zoom: 13 // 지도 줌 레벨
        });
        map.on("click", function onClick(event) {
          var geometry = event.point;
          var parameters = {
            layers: ["architecturedb"]
          };
          var features = map.queryRenderedFeatures(geometry, parameters);
          console.log(features);
          var db__name = features[0].properties.name;
          var db__facilityType = features[0].properties.facilityType;
          var db__description = features[0].properties.description;
          var db__imageURL = features[0].properties.imageURL;
          console.log(db__name);
          console.log(db__facilityType);
          console.log(db__description);
          console.log(db__imageURL);

          var popup = new mapboxgl.Popup()
            .setLngLat(event.lngLat)
            .setHTML(
              `<h2 class="db__name">${db__name}</h2>
        <div class="db__facilityType">${db__facilityType}</div>
        <div class="db__description">${db__description}</div>
        <img class="db__imageURL" src="${db__imageURL}" />
        <button class="db__btn"> + 여행 일정에 추가 </button>`
            )
            .addTo(map);
        });
      </script>
    </main>
  </body>
</html>
